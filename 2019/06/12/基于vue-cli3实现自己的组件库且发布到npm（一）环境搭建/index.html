<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#33363b">
    <meta name="msapplication-TileColor" content="#33363b">
    
    
    
    <meta name="keywords" content="Life, ARIA, Hexo">
    
    
    <link rel="apple-touch-icon" sizes="180x180" href="/favicons/apple-touch-icon.png">
    
    
    <link rel="icon" type="image/png" sizes="192x192" href="/favicons/android-chrome-192x192.png">
    
    
    <link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png">
    
    
    <link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png">
    
    
    <link rel="mask-icon" href="/favicons/safari-pinned-tab.svg" color="#33363b">
    
    
    <link rel="manifest" href="/favicons/site.webmanifest">
    
    
    <meta name="msapplication-config" content="/favicons/browserconfig.xml">
    
    
    <link rel="alternate" href="/atom.xml" title="黄紫茜的博客" type="application/atom+xml" />
    
    
    <link rel="shortcut icon" type="image/x-icon" href="/favicons/favicon.ico">
    
    
    <link rel="stylesheet" type="text/css" href="/css/normalize.css">
    <link rel="stylesheet" type="text/css" href="/css/index.css">
    
    <link rel="stylesheet" type="text/css" href="/css/sidebar.css">
    
    
<link rel="stylesheet" type="text/css" href="/css/page.css">
<link rel="stylesheet" type="text/css" href="/css/post.css">

    <link rel="stylesheet" type="text/css" href="/css/custom.css">
    <link rel="stylesheet" type="text/css" href="/css/atom-one-dark.css">
    <link rel="stylesheet" type="text/css" href="/css/lightgallery.min.css">
    <script type="text/javascript" src="/js/jquery.min.js"></script>
    <script defer type="text/javascript" src="/js/util.js"></script>
    <script defer type="text/javascript" src="/js/scrollspy.js"></script>
    <script defer type="text/javascript" src="/js/fontawesome-all.min.js"></script>
    <script defer type="text/javascript" src="/js/lightgallery.min.js"></script>
    <script defer type="text/javascript" src="/js/lg-fullscreen.min.js"></script>
    <script defer type="text/javascript" src="/js/lg-hash.min.js"></script>
    <script defer type="text/javascript" src="/js/lg-pager.min.js"></script>
    <script defer type="text/javascript" src="/js/lg-thumbnail.min.js"></script>
    <script defer type="text/javascript" src="/js/lg-zoom.min.js"></script>
    
    <script defer src="/js/busuanzi.pure.mini.js"></script>
    
    
    <script defer type="text/javascript" src="/js/search.js"></script>
    <script type="text/javascript">
    $(document).ready(function () {
      var searchPath = "search.xml";
      if (searchPath.length === 0) {
        searchPath = "search.xml";
      }
      var path = "/" + searchPath;
      searchFunc(path, "search-input", "search-result");
    });
    </script>
    
    
    <script defer type="text/javascript" src="/js/index.js"></script>
    
    <script defer type="text/javascript" src="/js/custom.js"></script>
    <title>基于vue cli3实现自己的组件库且发布到npm（一）环境搭建 | 黄紫茜的博客</title>
  </head>
  <body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans"  data-spy="scroll" data-target=".list-group">
    
<header id="header" class="header">
  <div class="container">
    <div class="header-container">
      
    </div>
    
<nav id="nav" class="nav">
  <a id="nav-toggle" class="nav-toggle" aria-hidden="true"><i class="fas fa-bars" aria-label="Toggle Navbar"></i></a>
  <ul id="menu" role="menubar" aria-hidden="false">
    
    <li role="menuitem"><a href="/">Home</a></li>
    
    <li role="menuitem"><a href="/archives/">Archives</a></li>
    
    <li role="menuitem"><a href="/categories/">Categories</a></li>
    
    <li role="menuitem"><a href="/tags/">Tags</a></li>
    
    <li role="menuitem"><a href="/about/">About</a></li>
    
  </ul>
</nav>


  </div>
</header>


    <main id="main" class="main">
      <div class="container">
        <div class="main-container">
          <div class="content">
            
<div id="post" class="post">
  
  <article class="post-article card" itemscope itemtype="http://schema.org/Article">
    <div class="post-block">
      <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/06/12/基于vue-cli3实现自己的组件库且发布到npm（一）环境搭建/">
      <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
       <meta itemprop="name" content="黄紫茜">
       <meta itemprop="description" content="">
       <meta itemprop="image" content="/images/logo.jpg">
      </span>
      <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
       <meta itemprop="name" content="黄紫茜的博客">
      </span>
    </div>
    <header class="post-header">
      <h1 class="post-title" itemprop="name headline">基于vue cli3实现自己的组件库且发布到npm（一）环境搭建</h1>
      <div class="post-meta">
        
        <span class="post-date">
          <i class="far fa-calendar-plus"></i><span><time title="post-date" itemprop="dateCreated datePublished" datetime="2019-06-12T15:13:13+08:00">2019-06-12 15:13:13</time></span>
        </span>
        
        
        
      </div>
    </header>
    <main class="post-main" itemprop="articleBody">
      <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><h2 id="安装vue-cli3-0"><a href="#安装vue-cli3-0" class="headerlink" title="安装vue-cli3.0"></a>安装vue-cli3.0</h2><p>因为我电脑之前有装了vue-cli2的，所以要先卸载以前的版本，再安装新的版本。</p>
<pre><code>npm uninstall vue-cli -g
</code></pre><p>然后再安装新版本</p>
<pre><code>npm install -g @vue/cli 
</code></pre><p>安装成功后用<code>vue -V</code>查看，发现还是2.9.x版本，我看了一下node版本是符合要求的，然后我真是的一脸懵逼。然后网上搜了下，最后找到了一个解决办法（window系统有遇到这个问题，mac没有）。</p>
<ol>
<li>把node完全卸载了，文件也删除干净。</li>
<li>然后下载nvm，<a href="https://github.com/coreybutler/nvm-windows/releases" target="_blank" rel="noopener">下载传送门</a>，选择相应的版本，然后选择下载nvm-setup.zip这个包，然后安装成功后，命令行输入nvm，会出现nvm版本号和一系列指令。</li>
<li>命令行输入 <code>nvm install node版本号</code>,就可以安装相应版本的node,最后<code>nvm use node版本号</code>使用指定版本的node</li>
<li>最后在命令行输入<code>npm install -g @vue/cli</code>，发现输出终于是3.x了，欢呼！！</li>
</ol>
<a id="more"></a>
<h2 id="创建github项目"><a href="#创建github项目" class="headerlink" title="创建github项目"></a>创建github项目</h2><p>为了后期维护，我把代码上传到了github上，<a href="https://github.com/zzilcc/zzilccComponent/tree/develop" target="_blank" rel="noopener">项目地址</a>,具体怎么上传到github请自行搜索。</p>
<p>代码上传后默认是提交到master分支，我们拉一个develop分支，在该分支上进行开发。</p>
<h2 id="项目结构"><a href="#项目结构" class="headerlink" title="项目结构"></a>项目结构</h2><h3 id="创建项目"><a href="#创建项目" class="headerlink" title="创建项目"></a>创建项目</h3><p>vue-cli3.0是通过 <code>create</code>创建，跟2.0是有区别。</p>
<pre><code>vue create zzilcc-ui
</code></pre><p>通过上面的命令，我们创建了一个新的项目。</p>
<p>运行<code>npm run serve</code>就能把项目起起来。</p>
<h3 id="调整目录"><a href="#调整目录" class="headerlink" title="调整目录"></a>调整目录</h3><p>我们需要一个目录存放示例，一个目录存放真的组件代码，所以我们将原先的src目录改名成examples，然后新增一个packages目录，用来放组件代码。</p>
<p>所以调整后的目录是这样的</p>
<p><img src="/2019/06/12/基于vue-cli3实现自己的组件库且发布到npm（一）环境搭建/目录结构.png" alt=""></p>
<h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><h3 id="重新配置入口为example-main-js"><a href="#重新配置入口为example-main-js" class="headerlink" title="重新配置入口为example/main.js"></a>重新配置入口为example/main.js</h3><p>因为我们刚把src目录改成了example，所以我们要修改一下项目的入口文件的路径，我们创建在根目录下创建一个vue.config.js文件。</p>
<figure class="hljs highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">	pages: &#123;</span><br><span class="line">		index: &#123;</span><br><span class="line">			entry: <span class="string">'examples/main.js'</span>, <span class="comment">// 修改src目录为examples</span></span><br><span class="line">			template: <span class="string">'public/index.html'</span>,</span><br><span class="line">			filename: <span class="string">'index.html'</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="支持对packages目录的支持"><a href="#支持对packages目录的支持" class="headerlink" title="支持对packages目录的支持"></a>支持对packages目录的支持</h3><p>packages是我们新增的，我们需要手动配置，要不然webpack是不会处理。</p>
<figure class="hljs highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">	pages: &#123;</span><br><span class="line">		index: &#123;</span><br><span class="line">			entry: <span class="string">'examples/main.js'</span>, <span class="comment">// 修改src目录为examples</span></span><br><span class="line">			template: <span class="string">'public/index.html'</span>,</span><br><span class="line">			filename: <span class="string">'index.html'</span></span><br><span class="line">		&#125;</span><br><span class="line">&#125;,</span><br><span class="line">	<span class="comment">// 扩展webpack位置，让packages加入编译</span></span><br><span class="line">	config.module</span><br><span class="line">		.rule(<span class="string">'js'</span>)</span><br><span class="line">		.incluede</span><br><span class="line">			.add(<span class="string">'packages'</span>)</span><br><span class="line">			.end()</span><br><span class="line">		.use(<span class="string">'babel'</span>)</span><br><span class="line">			.loader(<span class="string">'babel-loader'</span>)</span><br><span class="line">			.tap(<span class="function"><span class="params">options</span> =&gt;</span> &#123;</span><br><span class="line">				<span class="comment">// 修改它的选项</span></span><br><span class="line">				<span class="keyword">return</span> options</span><br><span class="line">			&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="编写组件"><a href="#编写组件" class="headerlink" title="编写组件"></a>编写组件</h2><h3 id="创建一个新组件"><a href="#创建一个新组件" class="headerlink" title="创建一个新组件"></a>创建一个新组件</h3><pre><code>1. 我们在packages目录下创建一个button文件夹，每个组件都一个文件夹
2. 在button文件夹下创建src文件夹，用来存放组件源码，并在src文件夹里创建一个z-button.vue
3. 在button文件里创建一个index.js,用来对外提供组件的引用
</code></pre><p><img src="/2019/06/12/基于vue-cli3实现自己的组件库且发布到npm（一）环境搭建/button1.png" alt=""></p>
<p>为了测试，我们在z-button.vue的template里写一个<code>&lt;button&gt;</code></p>
<p><img src="/2019/06/12/基于vue-cli3实现自己的组件库且发布到npm（一）环境搭建/button.png" alt=""></p>
<p>然后再button/index.js里写组件的install方法，创建相应的组件方法，供外部调用。</p>
<figure class="hljs highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入组件，组件必须声明name</span></span><br><span class="line"><span class="keyword">import</span> zButton <span class="keyword">from</span> <span class="string">'./src/z-button.vue'</span></span><br><span class="line"><span class="comment">// 为组件提供install方法，供按需引入</span></span><br><span class="line">zButton.install = <span class="function"><span class="keyword">function</span> (<span class="params">Vue</span>) </span>&#123;</span><br><span class="line">	Vue.component(zButton.name, zButton)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 默认导出组件</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> zButton</span><br></pre></td></tr></table></figure>
<h3 id="整合所有组件，对外导出"><a href="#整合所有组件，对外导出" class="headerlink" title="整合所有组件，对外导出"></a>整合所有组件，对外导出</h3><p>修改packages/index.js</p>
<figure class="hljs highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入z-button组件</span></span><br><span class="line"><span class="keyword">import</span> zButton <span class="keyword">from</span> <span class="string">'./button'</span></span><br><span class="line"><span class="comment">// 存储组件列表</span></span><br><span class="line"><span class="keyword">const</span> components = [</span><br><span class="line">	zButton</span><br><span class="line">]</span><br><span class="line"><span class="comment">// 定义 install 方法，接收 Vue 作为参数。如果使用 use 注册插件，则所有的组件都将被注册</span></span><br><span class="line"><span class="keyword">const</span> install = <span class="function"><span class="keyword">function</span> (<span class="params">Vue</span>) </span>&#123;</span><br><span class="line">	<span class="comment">// 判断是否安装</span></span><br><span class="line">	<span class="keyword">if</span> (install.installed) <span class="keyword">return</span></span><br><span class="line">	<span class="comment">// 遍历注册全局组件</span></span><br><span class="line">	components.map(<span class="function"><span class="params">component</span> =&gt;</span> Vue.component(component.name, component))</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 判断是否是直接引入文件</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="built_in">window</span> !== <span class="string">'undefined'</span> &amp;&amp; <span class="built_in">window</span>.Vue) &#123;</span><br><span class="line">	install(<span class="built_in">window</span>.Vue)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">	<span class="comment">// 导出的对象必须具有 install，才能被 Vue.use() 方法安装</span></span><br><span class="line">	install,</span><br><span class="line">	<span class="comment">// 以下是具体的组件列表</span></span><br><span class="line">	zButton</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="创建主题样式"><a href="#创建主题样式" class="headerlink" title="创建主题样式"></a>创建主题样式</h2><p>因为第一次建组件库，没什么经验，然后借鉴了好多ui组件库，比如element ui,iView,VV-UI等，我看到他们都没有在组件vue文件中去写相应的样式，也没有显示调用样式文件，然后研究了一下element ui的，发现它是将样式所有抽离出来，用gulp打包编译。然后我们在项目中需要引用样式文件。</p>
<h3 id="创建一个github新项目"><a href="#创建一个github新项目" class="headerlink" title="创建一个github新项目"></a>创建一个github新项目</h3><p>我创建了一个名为theme-default的github项目用来存放主题样式。然后得到了一个项目地址。</p>
<h3 id="创建样式文件目录"><a href="#创建样式文件目录" class="headerlink" title="创建样式文件目录"></a>创建样式文件目录</h3><p>我们在packages/下新建一个样式目录，叫做‘theme-default’，这个名字你可以随意。</p>
<h3 id="初始化样式文件"><a href="#初始化样式文件" class="headerlink" title="初始化样式文件"></a>初始化样式文件</h3><p>我们通过<code>npm init</code>初始化，然后命令行会出现一些内容让你填写，比如name,main,author等，关于git项目的选项，我们要填上第一步创建的github项目地址，然后结束后在theme-default目录下会出现package.json,里面的内容就是你刚刚填写的。</p>
<p>我们在样式目录下新建一个src目录用来放置样式文件，然后在src目录下创建button.scss,和index.scss.</p>
<p>然后安装一下scss/sass</p>
<pre><code>npm install -D sass-loader node-sass
</code></pre><p>在button.scss里先写</p>
<figure class="hljs highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.z-button</span> &#123;</span><br><span class="line">	<span class="attribute">display</span>: inline-block;</span><br><span class="line">	<span class="attribute">background</span>: <span class="number">#fff</span>;</span><br><span class="line">	<span class="attribute">cursor</span>: pointer;</span><br><span class="line">	<span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#eee</span>;</span><br><span class="line">	<span class="attribute">font-size</span>: <span class="number">14px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在index.scss</p>
<figure class="hljs highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@<span class="keyword">import</span> <span class="string">"./button.scss"</span></span><br></pre></td></tr></table></figure>
<h2 id="安装gulp"><a href="#安装gulp" class="headerlink" title="安装gulp"></a>安装gulp</h2><p>下面的命令都是在theme-default目录下执行</p>
<p>全局安装：</p>
<pre><code>npm install --global gulp
</code></pre><p>作为项目的开发依赖（devDependencies）安装：</p>
<pre><code>npm install --save-dev gulp
</code></pre><p>在theme-default目录下创建一个gulpfile.js，在改文件中编写</p>
<figure class="hljs highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">'use strict'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> &#123; series, src, dest &#125; = <span class="built_in">require</span>(<span class="string">'gulp'</span>)</span><br><span class="line"><span class="keyword">const</span> sass = <span class="built_in">require</span>(<span class="string">'gulp-sass'</span>)</span><br><span class="line"><span class="keyword">const</span> autoprefixer = <span class="built_in">require</span>(<span class="string">'gulp-autoprefixer'</span>)</span><br><span class="line"><span class="keyword">const</span> cssmin = <span class="built_in">require</span>(<span class="string">'gulp-cssmin'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">compile</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> src(<span class="string">'./src/*.scss'</span>)</span><br><span class="line">		.pipe(sass.sync())</span><br><span class="line">		.pipe(autoprefixer(&#123;</span><br><span class="line">			browsers: [<span class="string">'ie &gt; 9'</span>, <span class="string">'last 2 versions'</span>],</span><br><span class="line">			cascade: <span class="literal">false</span></span><br><span class="line">		&#125;))</span><br><span class="line">		.pipe(cssmin())</span><br><span class="line">		.pipe(dest(<span class="string">'../../lib/theme-default'</span>)) <span class="comment">// 这是输出地址，我写到了和组件编译后的地址</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">copyfont</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> src(<span class="string">'./src/fonts/**'</span>)</span><br><span class="line">		.pipe(cssmin())</span><br><span class="line">		.pipe(dest(<span class="string">'../../lib/fonts/theme-default'</span>))<span class="comment">// 同上</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">exports.build = series(compile, copyfont)</span><br></pre></td></tr></table></figure>
<h2 id="发布到npm"><a href="#发布到npm" class="headerlink" title="发布到npm"></a>发布到npm</h2><h3 id="配置命令"><a href="#配置命令" class="headerlink" title="配置命令"></a>配置命令</h3><p>我们在zzilcc-ui目录下的package.json的scripts里加一个lib命令</p>
<figure class="hljs highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">"scripts": &#123;</span><br><span class="line">	"serve": "vue-cli-service serve",</span><br><span class="line">	"build": "vue-cli-service build",</span><br><span class="line">	"lint": "vue-cli-service lint",</span><br><span class="line">	"lib": "vue-cli-service build --target lib --name zzilcc-ui --dest lib packages/index.js &amp;&amp; gulp build --gulpfile packages/theme-default/gulpfile.js"</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<p>然后运行lib命令  <code>npm run lib</code></p>
<p>该命令其实执行了两个命令，第一个是vue-cli3.0的vue-cli-service build</p>
<figure class="hljs highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">用法：vue-cli-service build [options] [entry|pattern]</span><br><span class="line">选项：</span><br><span class="line"></span><br><span class="line">--mode        指定环境模式 (默认值：production)</span><br><span class="line">--dest        指定输出目录 (默认值：dist)</span><br><span class="line">--modern      面向现代浏览器带自动回退地构建应用</span><br><span class="line">--target      app | lib | wc | wc-async (默认值：app)</span><br><span class="line">--name        库或 Web Components 模式下的名字 (默认值：package.json 中的 &quot;name&quot; 字段或入口文件名)</span><br><span class="line">--no-clean    在构建项目之前不清除目标目录</span><br><span class="line">--report      生成 report.html 以帮助分析包内容</span><br><span class="line">--report-json 生成 report.json 以帮助分析包内容</span><br><span class="line">--watch       监听文件变化</span><br></pre></td></tr></table></figure>
<p>vue-cli-service build 会在 dist/ 目录产生一个可用于生产环境的包，带有 JS/CSS/HTML 的压缩，和为更好的缓存而做的自动的 vendor chunk splitting。 –vue-cli官网</p>
<p>第二个命令是执行样式文件的gulp build</p>
<p>命令执行完后会在zzilcc-ui下生成一个lib文件</p>
<p><img src="/2019/06/12/基于vue-cli3实现自己的组件库且发布到npm（一）环境搭建/lib.png" alt=""></p>
<p>箭头指向的是生成主题样式文件，然后是html，和压缩后的js</p>
<h3 id="配置-package-json-文件中发布到-npm-的字段"><a href="#配置-package-json-文件中发布到-npm-的字段" class="headerlink" title="配置 package.json 文件中发布到 npm 的字段"></a>配置 package.json 文件中发布到 npm 的字段</h3><ol>
<li>name: 包名，该名字是唯一的。可在 npm 官网搜索名字，如果存在则需换个名字。我第一个名的名字叫”zzilccComponent”发布失败了，改成”zzilcc-component”才可以，不知道是不是大写不行</li>
<li>version: 版本号，每次发布至 npm 需要修改版本号，不能和历史版本号相同。</li>
<li>description: 描述。</li>
<li>main: 入口文件，该字段需指向我们最终编译后的包文件。</li>
<li>keyword：关键字，以空格分离希望用户最终搜索的词。</li>
<li>author：作者</li>
<li>private：是否私有，需要修改为 false 才能发布到 npm</li>
<li>license： 开源协议</li>
</ol>
<p>贴上我的配置</p>
<figure class="hljs highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">"name": "zzilcc-ui",</span><br><span class="line">"version": "0.1.4",</span><br><span class="line">"description": "基于 Vue 的简易组件库",</span><br><span class="line">"main": "lib/zzilcc-ui.umd.min.js",</span><br><span class="line">"keyword": "zzilcc-ui vue",</span><br><span class="line">"private": false,</span><br></pre></td></tr></table></figure>
<h3 id="添加npm发布忽略文件"><a href="#添加npm发布忽略文件" class="headerlink" title="添加npm发布忽略文件"></a>添加npm发布忽略文件</h3><p>我们在zzilcc-ui目录下新建一个.npmignore文件，语法和git的忽略文件是一样的，内容如下<br><figure class="hljs highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># 忽略目录</span><br><span class="line">examples/</span><br><span class="line">packages/</span><br><span class="line">public/</span><br><span class="line"></span><br><span class="line"># 忽略指定文件</span><br><span class="line">vue.config.js</span><br><span class="line">babel.config.js</span><br><span class="line">*.map</span><br></pre></td></tr></table></figure></p>
<h3 id="注册npm账号"><a href="#注册npm账号" class="headerlink" title="注册npm账号"></a>注册npm账号</h3><p>去<a href="https://www.npmjs.com/package/npm" target="_blank" rel="noopener">npm官网</a>注册一个账号，然后网站会发一封邮件到你注册的邮箱，点击邮件中的链接，就表示邮箱验证成功。</p>
<p>然后在zzilcc-ui目录打开命令行输入</p>
<pre><code>npm login
</code></pre><p>该命令会让你输如npm 账号，密码，邮箱，相应的输入你注册的账号，密码输入不会显示，输入完回车就行</p>
<h3 id="发布你的第一个npm包"><a href="#发布你的第一个npm包" class="headerlink" title="发布你的第一个npm包"></a>发布你的第一个npm包</h3><p>最后我们只要执行发布命令</p>
<pre><code>npm publish
</code></pre><p>成功后，去npm官网上搜索你写的npm name，搜到你相应的包就算成功了。</p>
<p><img src="/2019/06/12/基于vue-cli3实现自己的组件库且发布到npm（一）环境搭建/npm.png" alt=""></p>
<h2 id="结束语"><a href="#结束语" class="headerlink" title="结束语"></a>结束语</h2><p>下一篇文章我将会细讲怎么写一个组件，今天只是把环境搭好，有什么疑惑可以到<a href="https://github.com/zzilcc/zzilccComponent/issues" target="_blank" rel="noopener">issues</a>给我提问。要是觉得我写的还行，能帮助到你，也可以给我github项目star一下。</p>
<p>打赏植发钱</p>
<p>一入前端发直掉，</p>
<p>网络一线牵，</p>
<p>珍惜这段缘。</p>
<p>感觉要开始存钱植发了。</p>
<p><img width="100" src="/2019/06/12/基于vue-cli3实现自己的组件库且发布到npm（一）环境搭建/zf.png"></p>
<p><img width="120" src="/2019/06/12/基于vue-cli3实现自己的组件库且发布到npm（一）环境搭建/wxZf.png"></p>

    </main>
    <footer class="post-footer">
      
      <div class="post-tags">
        
        
        
        
        <a class="post-tag button" href="/tags/vue-vue-cli-webpack/" style="background: #fc6423;" rel="tag"><i class="fas fa-tags"></i>vue vue-cli webpack</a>
        
      </div>
      
    </footer>
  </article>
  
  
  <div class="post-nav">
    <div class="post-nav-next post-nav-item">
      
      <a href="/2019/05/28/半个小时学不会的正则表达式/" rel="next" title="半个小时学不会的正则表达式"><i class="fas fa-angle-left"></i><span class="nav-title">半个小时学不会的正则表达式</span></a>
      
    </div>
    <div class="post-nav-prev post-nav-item">
      
      <a href="/2019/06/15/javaScript-数组方法总结/" rel="prev" title="javaScript 数组方法总结"><span class="nav-title">javaScript 数组方法总结</span><i class="fas fa-angle-right"></i></a>
      
    </div>
  </div>
  
  
</div>

          </div>
          
          
          
<aside class="sidebar" id="sidebar" >
  
  <div class="search">
    <div class="form-group">
      <i class="fas fa-search"></i><input type="search" id="search-input" name="q" results="0" placeholder="Search" class="form-control"/>
    </div>
  </div>
  <div class="search-result-box" id="search-result"></div>
  
  
<div class="info sidebar-item" id="info">
  
  <img class="author-avatar" src="/images/logo.jpg" alt="黄紫茜">
  
  <h1 class="author-name">黄紫茜</h1>
  <h2 class="author-description"></h2>
  <div class="site-count">
    
    <div class="archives-count">
      <div class="site-count-title">Archives</div>
      <div><a href="/archives/">24</a></div>
    </div>
    
    
    
    <span class="site-count-divider divider">|</span>
    
    <div class="categories-count">
      <div class="site-count-title">Categories</div>
      <div><a href="/categories/">4</a></div>
    </div>
    
    
    
    <span class="site-count-divider divider">|</span>
    
    <div class="tags-count">
      <div class="site-count-title">Tags</div>
      <div><a href="/tags/">18</a></div>
    </div>
    
  </div>
  
  
  
</div>


  <div >
    
    




<hr>
<div class="post-toc sidebar-item" id="toc-div">
  <div><i class="fas fa-list-ol"></i>Table of Contents</div>
  <div class="post-toc-content"><ol class="list-group toc"><li class="toc-item toc-level-2"><a class="list-group-item toc-link" href="#前言"><span class="toc-text">前言</span></a></li><li class="toc-item toc-level-2"><a class="list-group-item toc-link" href="#安装vue-cli3-0"><span class="toc-text">安装vue-cli3.0</span></a></li><li class="toc-item toc-level-2"><a class="list-group-item toc-link" href="#创建github项目"><span class="toc-text">创建github项目</span></a></li><li class="toc-item toc-level-2"><a class="list-group-item toc-link" href="#项目结构"><span class="toc-text">项目结构</span></a><ol class="list-group toc-child"><li class="toc-item toc-level-3"><a class="list-group-item toc-link" href="#创建项目"><span class="toc-text">创建项目</span></a></li><li class="toc-item toc-level-3"><a class="list-group-item toc-link" href="#调整目录"><span class="toc-text">调整目录</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="list-group-item toc-link" href="#配置"><span class="toc-text">配置</span></a><ol class="list-group toc-child"><li class="toc-item toc-level-3"><a class="list-group-item toc-link" href="#重新配置入口为example-main-js"><span class="toc-text">重新配置入口为example/main.js</span></a></li><li class="toc-item toc-level-3"><a class="list-group-item toc-link" href="#支持对packages目录的支持"><span class="toc-text">支持对packages目录的支持</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="list-group-item toc-link" href="#编写组件"><span class="toc-text">编写组件</span></a><ol class="list-group toc-child"><li class="toc-item toc-level-3"><a class="list-group-item toc-link" href="#创建一个新组件"><span class="toc-text">创建一个新组件</span></a></li><li class="toc-item toc-level-3"><a class="list-group-item toc-link" href="#整合所有组件，对外导出"><span class="toc-text">整合所有组件，对外导出</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="list-group-item toc-link" href="#创建主题样式"><span class="toc-text">创建主题样式</span></a><ol class="list-group toc-child"><li class="toc-item toc-level-3"><a class="list-group-item toc-link" href="#创建一个github新项目"><span class="toc-text">创建一个github新项目</span></a></li><li class="toc-item toc-level-3"><a class="list-group-item toc-link" href="#创建样式文件目录"><span class="toc-text">创建样式文件目录</span></a></li><li class="toc-item toc-level-3"><a class="list-group-item toc-link" href="#初始化样式文件"><span class="toc-text">初始化样式文件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="list-group-item toc-link" href="#安装gulp"><span class="toc-text">安装gulp</span></a></li><li class="toc-item toc-level-2"><a class="list-group-item toc-link" href="#发布到npm"><span class="toc-text">发布到npm</span></a><ol class="list-group toc-child"><li class="toc-item toc-level-3"><a class="list-group-item toc-link" href="#配置命令"><span class="toc-text">配置命令</span></a></li><li class="toc-item toc-level-3"><a class="list-group-item toc-link" href="#配置-package-json-文件中发布到-npm-的字段"><span class="toc-text">配置 package.json 文件中发布到 npm 的字段</span></a></li><li class="toc-item toc-level-3"><a class="list-group-item toc-link" href="#添加npm发布忽略文件"><span class="toc-text">添加npm发布忽略文件</span></a></li><li class="toc-item toc-level-3"><a class="list-group-item toc-link" href="#注册npm账号"><span class="toc-text">注册npm账号</span></a></li><li class="toc-item toc-level-3"><a class="list-group-item toc-link" href="#发布你的第一个npm包"><span class="toc-text">发布你的第一个npm包</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="list-group-item toc-link" href="#结束语"><span class="toc-text">结束语</span></a></li></ol></div>
</div>



    
    
    
<hr>
<div class="social-link sidebar-item">
  <div><i class="far fa-address-card"></i>Social Links</p></div>
  <ul>
    
    <li><i class="fas fa-envelope"></i><a href="hzq_56@163.com" target="_blank">E-Mail</a></li>
    
    <li><i class="fab fa-github"></i><a href="https://github.com/zzilcc" target="_blank">GitHub</a></li>
    
  </ul>
</div>


    
    
    
<hr>
<div class="blogroll sidebar-item">
  <div><i class="fas fa-link"></i>Blogroll</div>
  <ul>
    
    <li><a href="https://github.com/zzilcc" target="_blank">GitHub</a></li>
    
    <li><a href="https://developer.mozilla.org/" target="_blank">MDN</a></li>
    
    <li><a href="https://mozilla.github.io/nunjucks/" target="_blank">Nunjucks</a></li>
    
  </ul>
</div>


    
  </div>
  <div class="sidebar-sticky">
      <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=450 src="//music.163.com/outchain/player?type=0&id=2317836514&auto=1&height=430"></iframe>
  </div>
</aside>


          
        </div>
      </div>
    </main>
    
<footer id="footer" class="footer" style="background: #33363b;">
  <div class="container">
    <div class="back-to-top">
      <button id="back-to-top"><i class="fas fa-angle-double-up" aria-label="Back to Top"></i></button>
    </div>
    <div class="footer-container">
      <div class="footer-left">
        <div class="copyright">
          <span class="author">黄紫茜</span><span class="year"><i class="far fa-copyright"></i>2019</span>
        </div>
        
        
<div class="busuanzi">
  <span id="busuanzi_container_site_pv"><i class="fas fa-eye" aria-label="Site Visit Count" aria-hidden="false"></i><span id="busuanzi_value_site_pv"></span></span><span id="busuanzi_container_site_uv"><i class="fas fa-user" aria-label="Site User Count" aria-hidden="false"></i><span id="busuanzi_value_site_uv"></span></span><span id="busuanzi_container_page_pv"><i class="far fa-file-alt"></i><span id="busuanzi_value_page_pv" aria-label="Page Click Count" aria-hidden="false"></span></span>
</div>


        
      </div>
      <div class="footer-right">
        <div class="custom-info">
          
          托管于<i class="fab fa-github-alt"></i><a href="https://pages.github.com/" target="_blank">GitHub Pages</a>
          
        </div>
        <div class="powered-by">
          Proudly Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> | Theme is <a href="https://github.com/AlynxZhou/hexo-theme-aria/" target="_blank">ARIA</a>
        </div>
        <span id="busuanzi_container_site_uv"> 
            本站访客数<span id="busuanzi_value_site_uv"></span>人次
        </span>
      </div>
    </div>
  </div>
</footer>
<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>


  </body>
</html>
